{
  "result": {
    "relationships": [
      {
        "source_table": "labs",
        "target_table": "diagnosis",
        "source_column": "subject_id",
        "target_column": "subject_id",
        "relation_type": "M:N",
        "confidence": 0.78,
        "description": "Both tables are transactional/event-like and share subject_id; a patient can have many lab rows and many diagnosis rows, so joining on subject_id alone creates a many-to-many relationship (not a strict FK). This is better modeled via a Patient/Encounter dimension if available.",
        "llm_inferred": true
      },
      {
        "source_table": "labs",
        "target_table": "diagnosis",
        "source_column": "chart_time",
        "target_column": "chart_time",
        "relation_type": "M:N",
        "confidence": 0.55,
        "description": "chart_time is repeated (not unique) and is a timestamp rather than an identifier; matching labs to diagnoses by exact time is unreliable and not a true FK in most clinical schemas.",
        "llm_inferred": true
      }
    ],
    "hierarchy": [
      {
        "level": 1,
        "entity_name": "Patient",
        "anchor_column": "subject_id",
        "mapping_table": null,
        "confidence": 0.86
      },
      {
        "level": 2,
        "entity_name": "Laboratory Result (Lab Event)",
        "anchor_column": "subject_id",
        "mapping_table": "labs",
        "confidence": 0.84
      },
      {
        "level": 2,
        "entity_name": "Diagnosis Event",
        "anchor_column": "subject_id",
        "mapping_table": "diagnosis",
        "confidence": 0.84
      }
    ],
    "reasoning": "The new/existing 'labs' table is a lab measurement fact table (transactional). The only plausible shared key with other tables is subject_id, which typically references a Patient entity; however, no explicit patient table is provided, so we cannot assert a concrete FK target. Between labs and diagnosis, shared columns (subject_id, chart_time) do not form a reliable parent key: both tables contain multiple rows per subject and per time, so any direct linkage is many-to-many and should be treated as a join attribute rather than a strict FK. chart_time is repeated and semantically a timestamp, so it is not a strong FK candidate."
  },
  "prompt_hash": "b3660e263fc71549fdea83bef4821ff0",
  "cached_at": "2025-12-21T20:52:27.891903",
  "context_summary": {
    "filename": "unknown",
    "num_columns": 0
  }
}