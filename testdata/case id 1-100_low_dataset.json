[
  {
    "id": 1,
    "question": "1~100번 환자들의 심박수(HR) 최댓값을 순서대로 리스트로 알려주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_max_hr(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['Solar8000/HR'], 1)\n        if vals is None or len(vals) == 0: return None\n        return float(np.nanmax(vals[:, 0]))\n    except: return None\n\ndef get_hr_max_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_max_hr, range(start_id, end_id + 1)))\n    return results",
    "answer": "[139.0, 177.0, 151.0, 149.0, 107.0, 119.0, 117.0, 139.0, 141.0, 100.0, 96.0, 175.0, 142.0, 101.0, 103.0, 112.0, 178.0, 157.0, 115.0, 192.0, 107.0, 115.0, 116.0, 109.0, 103.0, 132.0, 106.0, 171.0, 131.0, 108.0, 127.0, 153.0, 149.0, 131.0, 153.0, 87.0, 110.0, 154.0, 82.0, 110.0, 134.0, 76.0, 174.0, 128.0, 79.0, 219.0, 118.0, 152.0, 197.0, 114.0, 165.0, 124.0, 101.0, 202.0, 123.0, 188.0, 107.0, 125.0, 113.0, 122.0, 125.0, 116.0, 124.0, 101.0, 115.0, 87.0, 168.0, 117.0, 210.0, 165.0, 108.0, 93.0, 136.0, 135.0, 150.0, 87.0, 124.0, 96.0, 300.0, 130.0, 108.0, 143.0, 89.0, 98.0, 94.0, 107.0, 176.0, 92.0, 124.0, 114.0, 171.0, 104.0, 140.0, 107.0, 138.0, 186.0, 141.0, 102.0, 219.0, 101.0]",
    "detail_score": 0.75
  },
  {
    "id": 2,
    "question": "1~100번 환자들의 심박수(HR) 최솟값을 순서대로 리스트로 알려주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_min_hr(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['Solar8000/HR'], 1)\n        if vals is None or len(vals) == 0: return None\n        return float(np.nanmin(vals[:, 0]))\n    except: return None\n\ndef get_hr_min_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_min_hr, range(start_id, end_id + 1)))\n    return results",
    "answer": "[57.0, 54.0, 52.0, 60.0, 73.0, 72.0, 51.0, 38.0, 52.0, 52.0, 46.0, 0.0, 44.0, 0.0, 55.0, 50.0, 49.0, 61.0, 37.0, 63.0, 49.0, 53.0, 62.0, 61.0, 0.0, 30.0, 43.0, 0.0, 0.0, 53.0, 45.0, 49.0, 57.0, 0.0, 46.0, 44.0, 46.0, 61.0, 51.0, 0.0, 55.0, 39.0, 58.0, 53.0, 38.0, 61.0, 46.0, 0.0, 0.0, 47.0, 52.0, 58.0, 40.0, 55.0, 68.0, 59.0, 41.0, 47.0, 44.0, 0.0, 46.0, 58.0, 52.0, 47.0, 41.0, 45.0, 52.0, 55.0, 55.0, 39.0, 50.0, 51.0, 56.0, 44.0, 38.0, 55.0, 0.0, 54.0, 55.0, 68.0, 50.0, 65.0, 42.0, 52.0, 41.0, 82.0, 96.0, 55.0, 61.0, 52.0, 58.0, 54.0, 48.0, 44.0, 49.0, 53.0, 49.0, 51.0, 63.0, 48.0]",
    "detail_score": 0.7
  },
  {
    "id": 3,
    "question": "1~100번 환자들의 심박수(HR) 중간값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_median_hr(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['Solar8000/HR'], 1)\n        if vals is None or len(vals) == 0: return None\n        val = np.nanmedian(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_hr_median_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_median_hr, range(start_id, end_id + 1)))\n    return results",
    "answer": "[74.0, 80.0, 74.0, 76.0, 85.0, 84.0, 70.0, 54.0, 69.0, 75.0, 68.0, 79.0, 63.0, 70.0, 60.0, 78.0, 71.0, 87.0, 76.0, 85.0, 60.0, 74.0, 77.0, 78.0, 82.0, 54.0, 57.0, 88.0, 54.0, 66.0, 68.0, 61.0, 71.0, 76.0, 55.0, 49.0, 54.0, 86.0, 57.0, 75.0, 74.0, 57.0, 75.0, 70.0, 52.0, 80.0, 68.0, 60.0, 66.0, 65.0, 68.0, 82.0, 63.0, 77.0, 98.0, 84.0, 51.0, 68.0, 81.0, 88.0, 65.0, 71.0, 64.0, 64.0, 49.0, 55.0, 65.0, 75.0, 71.0, 65.0, 69.0, 68.0, 65.0, 66.0, 88.0, 61.0, 59.0, 78.0, 90.0, 83.0, 66.0, 78.0, 62.0, 64.0, 59.0, 96.0, 116.0, 64.0, 76.0, 70.0, 80.0, 61.0, 59.0, 65.0, 113.0, 82.0, 59.0, 67.0, 75.0, 73.0]",
    "detail_score": 0.75
  },
  {
    "id": 4,
    "question": "1~100번 환자들의 ABP 평균값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_mean_abp(case_id):\n    try:\n        # ABP Mean = Solar8000/ART_MBP 트랙 사용\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_MBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        val = np.nanmean(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_abp_mean_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_mean_abp, range(start_id, end_id + 1)))\n    return results",
    "answer": "[81.86, null, -3.1, 69.79, null, null, 82.36, null, null, 80.18, null, 70.66, 69.89, -0.36, null, 75.79, 72.87, null, 67.1, 71.05, null, 84.49, null, 77.4, 84.12, 68.27, 73.86, 80.97, 79.21, null, 68.95, 0.89, null, 87.21, null, null, null, 67.67, null, null, 79.4, null, 75.51, 79.47, null, 81.81, null, null, 66.51, 77.37, 86.83, 73.23, 87.05, null, 73.09, 66.76, null, 75.12, 61.56, 79.27, 77.74, null, null, 86.34, 85.62, 86.44, 67.04, 61.39, 77.38, 80.44, null, null, null, 73.24, 68.67, 85.34, 81.74, null, 82.24, null, null, null, 78.24, 81.78, null, null, 71.1, null, 93.7, null, -8.3, 66.84, 68.2, 72.71, null, 77.19, 85.07, 95.33, null, null]",
    "detail_score": 0.75
  },
  {
    "id": 5,
    "question": "1~100번 환자들의 ABP 최댓값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_max_abp(case_id):\n    try:\n        # ABP Max = Solar8000/ART_SBP (수축기) 트랙 사용\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_SBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        val = np.nanmax(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_abp_max_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_max_abp, range(start_id, end_id + 1)))\n    return results",
    "answer": "[322.0, null, 57.0, 239.0, null, null, 268.0, null, null, 282.0, null, 299.0, 167.0, 1.0, null, 234.0, 214.0, null, 154.0, 150.0, null, 267.0, null, 199.0, 179.0, 244.0, 265.0, 189.0, 274.0, null, 199.0, 1.0, null, 231.0, null, null, null, 216.0, null, null, 239.0, null, 212.0, 205.0, null, 205.0, null, null, 273.0, 186.0, 185.0, 175.0, 290.0, null, 185.0, 228.0, null, 294.0, 252.0, 233.0, 270.0, null, null, 202.0, 305.0, 217.0, 273.0, 247.0, 260.0, 265.0, null, null, null, 295.0, 244.0, 286.0, 253.0, null, 249.0, null, null, null, 162.0, 198.0, null, null, 216.0, null, 300.0, null, 6.0, 280.0, 225.0, 318.0, null, 337.0, 222.0, 297.0, null, null]",
    "detail_score": 0.75
  },
  {
    "id": 6,
    "question": "1~100번 환자들의 ABP 최솟값(0이하 노이즈 제거)을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_min_abp_filtered(case_id):\n    try:\n        # ABP Min = Solar8000/ART_DBP (이완기) 트랙 사용\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_DBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        data = vals[:, 0]\n        # 0보다 큰 값만 추출 (0이하 노이즈 제거)\n        valid_data = data[data > 0]\n        \n        if len(valid_data) > 0:\n            return round(float(np.min(valid_data)), 2)\n        else:\n            return None\n    except: return None\n\ndef get_abp_min_filtered_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_min_abp_filtered, range(start_id, end_id + 1)))\n    return results",
    "answer": "[1.0, null, null, 1.0, null, null, 1.0, null, null, 16.0, null, 1.0, 1.0, 1.0, null, 1.0, 1.0, null, 12.0, 1.0, null, 5.0, null, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, null, 1.0, 1.0, null, 1.0, null, null, null, 1.0, null, null, 1.0, null, 1.0, 1.0, null, 2.0, null, null, 1.0, 14.0, 5.0, 1.0, 1.0, null, 1.0, 1.0, null, 1.0, 1.0, 2.0, 1.0, null, null, 9.0, 1.0, 37.0, 1.0, 1.0, 1.0, 1.0, null, null, null, 1.0, 1.0, 1.0, 2.0, null, 1.0, null, null, null, 1.0, 15.0, null, null, 3.0, null, 1.0, null, null, 1.0, 1.0, 1.0, null, 7.0, 1.0, 2.0, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 7,
    "question": "1~100번 환자들의 ABP 중간값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_median_abp(case_id):\n    try:\n        # ABP의 중심 경향(Median) = Solar8000/ART_MBP 사용\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_MBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        # 결측치 제외 중간값 계산\n        val = np.nanmedian(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_abp_median_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_median_abp, range(start_id, end_id + 1)))\n    return results",
    "answer": "[80.0, null, -5.0, 71.0, null, null, 87.0, null, null, 79.0, null, 68.0, 75.0, -1.0, null, 81.0, 72.0, null, 67.0, 72.0, null, 93.0, null, 88.0, 86.0, 77.0, 77.0, 82.0, 84.0, null, 76.0, 1.0, null, 87.0, null, null, null, 69.0, null, null, 82.0, null, 73.0, 82.0, null, 87.0, null, null, 81.0, 77.0, 97.0, 75.0, 86.0, null, 72.0, 68.0, null, 72.0, 68.0, 83.0, 79.0, null, null, 86.0, 87.0, 85.0, 77.0, 75.0, 87.0, 91.0, null, null, null, 85.0, 70.0, 82.0, 87.0, null, 84.0, null, null, null, 79.0, 84.0, null, null, 70.0, null, 97.0, null, -9.0, 67.0, 76.0, 74.0, null, 77.0, 87.0, 100.0, null, null]",
    "detail_score": 0.75
  },
  {
    "id": 8,
    "question": "1~100번 환자들의 SpO2 평균값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_mean_spo2(case_id):\n    try:\n        # SpO2 트랙 로드 (Solar8000/PLETH_SPO2)\n        vals = vitaldb.load_case(case_id, ['Solar8000/PLETH_SPO2'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        # NaN 제외하고 평균 계산\n        val = np.nanmean(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_spo2_mean_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_mean_spo2, range(start_id, end_id + 1)))\n    return results",
    "answer": "[98.73, 99.94, 98.37, 99.73, 99.82, 98.83, 99.66, 98.92, 99.61, 99.17, 99.26, 99.21, 99.36, 98.67, 97.21, 98.33, 98.54, 98.28, 100.0, 99.66, 99.89, 99.63, 96.37, 99.43, 98.97, 99.54, 99.8, 99.4, 99.85, 99.73, 99.48, 99.06, 98.59, 99.22, 99.74, 99.79, 99.12, 99.36, 99.67, 97.88, 99.43, 98.15, 99.87, 99.98, 99.57, 99.78, 99.59, 99.79, 95.91, 99.92, 99.88, 99.41, 99.88, 99.39, 99.57, 99.95, 99.05, 99.99, 97.07, 99.14, 99.16, 99.5, 99.09, 99.73, 99.62, 99.11, 99.35, 98.06, 97.66, 99.35, 97.57, 99.62, 99.28, 99.45, 98.42, 99.85, 99.74, 98.42, 99.68, 98.15, 99.44, 98.86, 99.5, 99.28, 99.27, 98.02, 98.06, 99.54, 99.7, 99.67, 99.95, 97.73, 99.97, 99.1, 99.61, 100.0, 99.93, 99.79, 99.7, 99.4]",
    "detail_score": 0.8
  },
  {
    "id": 9,
    "question": "1~100번 환자들의 SpO2 최솟값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_min_spo2(case_id):\n    try:\n        # SpO2 트랙 로드\n        vals = vitaldb.load_case(case_id, ['Solar8000/PLETH_SPO2'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        # 필터링 없이 순수 최솟값 계산 (np.nanmin)\n        val = np.nanmin(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_spo2_min_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_min_spo2, range(start_id, end_id + 1)))\n    return results",
    "answer": "[77.0, 85.0, 77.0, 81.0, 79.0, 65.0, 53.0, 76.0, 82.0, 91.0, 75.0, 77.0, 88.0, 68.0, 81.0, 80.0, 73.0, 78.0, 96.0, 66.0, 82.0, 76.0, 59.0, 83.0, 78.0, 78.0, 69.0, 90.0, 79.0, 96.0, 81.0, 84.0, 73.0, 77.0, 69.0, 71.0, 76.0, 73.0, 83.0, 68.0, 86.0, 66.0, 81.0, 86.0, 82.0, 79.0, 85.0, 82.0, 60.0, 81.0, 84.0, 81.0, 83.0, 64.0, 95.0, 85.0, 71.0, 98.0, 83.0, 69.0, 81.0, 75.0, 87.0, 81.0, 82.0, 87.0, 96.0, 42.0, 58.0, 76.0, 79.0, 82.0, 82.0, 66.0, 81.0, 80.0, 67.0, 81.0, 96.0, 84.0, 82.0, 80.0, 75.0, 49.0, 83.0, 82.0, 65.0, 75.0, 78.0, 83.0, 89.0, 56.0, 93.0, 74.0, 74.0, 98.0, 78.0, 54.0, 77.0, 72.0]",
    "detail_score": 0.75
  },
  {
    "id": 10,
    "question": "1~100번 환자들의 SpO2 중간값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_median_spo2(case_id):\n    try:\n        # SpO2 트랙 로드\n        vals = vitaldb.load_case(case_id, ['Solar8000/PLETH_SPO2'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        # 중간값(Median) 계산 - 이상치에 강함\n        val = np.nanmedian(vals[:, 0])\n        return round(float(val), 2)\n    except: return None\n\ndef get_spo2_median_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_median_spo2, range(start_id, end_id + 1)))\n    return results",
    "answer": "[99.0, 100.0, 99.0, 100.0, 100.0, 99.0, 100.0, 99.0, 100.0, 99.0, 99.0, 100.0, 100.0, 100.0, 100.0, 99.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 100.0, 100.0, 99.0, 100.0, 100.0, 98.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 97.0, 99.0, 99.0, 100.0, 99.0, 100.0, 100.0, 99.0, 100.0, 100.0, 98.0, 100.0, 98.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0, 99.0, 100.0, 100.0, 100.0, 100.0, 100.0, 100.0]",
    "detail_score": 0.9
  },
  {
    "id": 11,
    "question": "1~100번 환자들의 BIS 평균값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_mean_bis(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['BIS/BIS'], 1)\n        if vals is None or len(vals) == 0: return None\n        bis_data = vals[:, 0]\n        # 0을 포함하여 평균 계산 (NaN만 제거)\n        valid_bis = bis_data[~np.isnan(bis_data)]\n        if len(valid_bis) == 0: return None\n        return round(float(np.mean(valid_bis)), 2)\n    except: return None\n\ndef get_bis_mean_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_mean_bis, range(start_id, end_id + 1)))\n    return results",
    "answer": "[44.61, 47.98, 36.95, 38.75, 47.12, 47.17, 39.46, 35.22, 46.31, 45.98, null, 46.24, 28.62, 41.11, null, 39.16, 35.61, 0.0, 40.14, 41.94, 35.01, 15.37, null, 35.34, 50.3, 36.46, 30.55, null, 42.18, 42.98, 43.46, null, 26.16, 39.95, 35.85, 38.1, 41.68, 39.91, 0.0, 38.14, 48.28, 38.75, 42.05, 43.0, 48.29, 41.45, 38.69, 50.71, 38.86, 41.76, null, 51.73, 36.39, 38.31, 44.56, 43.7, 39.02, 36.37, 52.01, 43.92, 44.36, 50.01, null, 40.5, 31.0, 42.31, 36.86, 38.74, 42.09, 39.3, 39.7, 42.67, null, 40.1, 43.69, 45.75, 44.73, 44.87, 45.55, 42.73, 41.25, 36.96, 40.8, 38.61, 42.11, 0.0, 53.08, 37.96, 44.79, 31.48, 44.61, 40.62, 25.13, 46.95, 34.64, 45.76, 40.52, 34.29, null, 43.85]",
    "detail_score": 0.75
  },
  {
    "id": 12,
    "question": "1~100번 환자들의 BIS 최솟값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_min_bis(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['BIS/BIS'], 1)\n        if vals is None or len(vals) == 0: return None\n        bis_data = vals[:, 0]\n        # 0을 포함하여 최솟값 계산\n        val = np.nanmin(bis_data)\n        if np.isnan(val): return None\n        return round(float(val), 2)\n    except: return None\n\ndef get_bis_min_batch_fast(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_min_bis, range(start_id, end_id + 1)))\n    return results",
    "answer": "[0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, null, 0.0]",
    "detail_score": 0.7
  },
  {
    "id": 13,
    "question": "1~100번 환자들의 BIS 중간값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_median_bis(case_id):\n    try:\n        vals = vitaldb.load_case(case_id, ['BIS/BIS'], 1)\n        if vals is None or len(vals) == 0: return None\n        # 0을 포함하여 중간값 계산\n        val = np.nanmedian(vals[:, 0])\n        if np.isnan(val): return None\n        return round(float(val), 2)\n    except: return None\n\ndef get_bis_median_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_median_bis, range(start_id, end_id + 1)))\n    return results",
    "answer": "[48.0, 46.9, 34.2, 34.2, 48.1, 45.5, 40.2, 37.7, 48.3, 46.1, null, 46.9, 29.3, 42.0, null, 38.1, 35.4, 0.0, 40.8, 41.6, 33.7, 0.0, null, 42.8, 50.0, 35.3, 29.8, null, 42.0, 42.8, 44.0, null, 32.1, 41.7, 32.8, 36.6, 41.1, 41.8, 0.0, 41.3, 51.9, 39.9, 42.1, 41.3, 43.7, 41.4, 40.5, 49.2, 40.6, 41.8, null, 52.1, 37.9, 38.6, 46.6, 45.3, 40.6, 34.8, 65.1, 41.6, 45.8, 49.9, null, 45.6, 31.9, 46.8, 42.5, 31.7, 41.3, 39.8, 43.2, 46.7, null, 36.0, 45.0, 41.9, 45.6, 47.0, 43.8, 45.9, 43.8, 42.0, 42.5, 37.3, 40.7, 0.0, 60.9, 36.9, 44.4, 39.5, 45.1, 41.3, 27.55, 46.5, 33.4, 45.4, 38.5, 36.6, null, 48.1]",
    "detail_score": 0.8
  },
  {
    "id": 14,
    "question": "1~100번 환자들의 수술 시간(분 단위)을 각각 구해주세요.",
    "tool": "import pandas as pd\n\ndef get_op_duration_batch(start_id=1, end_id=100):\n    df_cases = pd.read_csv('https://api.vitaldb.net/cases')\n    df_selected = df_cases[(df_cases['caseid'] >= start_id) & (df_cases['caseid'] <= end_id)].copy()\n    # 수술 종료(opend) - 수술 시작(opstart)을 60으로 나누어 분 단위 계산\n    df_selected['duration_min'] = (df_selected['opend'] - df_selected['opstart']) / 60\n    return [round(d, 1) if pd.notnull(d) else None for d in df_selected['duration_min']]",
    "answer": "[145.0, 215.0, 32.0, 255.0, 295.0, 30.0, 190.0, 70.0, 40.0, 290.0, 65.0, 425.0, 103.0, 30.0, 25.0, 160.0, 260.0, 30.0, 405.0, 374.8, 140.0, 190.0, 30.0, 50.0, 200.0, 110.0, 230.0, 380.0, 285.0, 135.0, 119.7, 30.0, 50.0, 365.0, 50.0, 60.0, 150.0, 136.7, 23.1, 75.0, 135.0, 195.0, 185.0, 178.9, 50.0, 115.0, 85.0, 165.0, 110.0, 205.0, 85.0, 185.0, 165.0, 200.0, 292.6, 405.0, 125.0, 180.0, 15.0, 170.0, 105.0, 105.0, 70.0, 175.0, 150.0, 113.0, 105.0, 70.0, 70.0, 155.0, 80.0, 100.0, 50.0, 215.0, 335.0, 180.0, 130.0, 37.4, 290.0, 15.0, 170.0, 30.0, 250.0, 235.0, 64.0, 45.0, 145.0, 90.0, 285.0, 50.0, 175.0, 43.4, 30.0, 415.0, 25.0, 589.6, 160.0, 75.4, 30.0, 40.0]",
    "detail_score": 0.95
  },
  {
    "id": 15,
    "question": "1~100번 환자들의 수축기 혈압(SBP) 평균값을 구해주세요. (0 이하 노이즈 제외)",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_sbp_mean_filtered(case_id):\n    try:\n        # SBP = 'Solar8000/ART_SBP' 트랙\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_SBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        sbp_data = vals[:, 0]\n        # 0 이하 노이즈 및 NaN 제외\n        valid_sbp = sbp_data[(sbp_data > 0) & (~np.isnan(sbp_data))]\n        \n        if len(valid_sbp) == 0: return None\n        return round(float(np.mean(valid_sbp)), 2)\n    except: return None\n\ndef get_sbp_mean_batch_filtered(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_sbp_mean_filtered, range(start_id, end_id + 1)))\n    return results",
    "answer": "[127.67, null, 26.55, 107.94, null, null, 114.75, null, null, 128.39, null, 96.19, 102.83, 1.0, null, 120.9, 108.11, null, 110.21, 104.69, null, 124.23, null, 120.5, 112.14, 109.46, 110.09, 110.63, 111.96, null, 100.28, 1.0, null, 123.9, null, null, null, 106.14, null, null, 112.23, null, 118.62, 103.43, null, 121.1, null, null, 122.76, 110.19, 130.6, 116.29, 116.15, null, 113.67, 101.16, null, 120.06, 95.74, 118.88, 109.18, null, null, 122.48, 125.02, 117.36, 121.12, 100.78, 122.84, 132.17, null, null, null, 110.18, 102.09, 115.52, 127.54, null, 129.1, null, null, null, 107.33, 119.04, null, null, 87.49, null, 127.53, null, 5.33, 103.33, 116.96, 108.41, null, 111.98, 129.28, 132.59, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 16,
    "question": "1~100번 환자들의 수축기 혈압(SBP) 최댓값을 각각 구해주세요.",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_sbp_max(case_id):\n    try:\n        # SBP = 'Solar8000/ART_SBP' 트랙\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_SBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        sbp_data = vals[:, 0]\n        # 모든 값이 NaN인 경우 제외\n        if np.all(np.isnan(sbp_data)): return None\n            \n        # 최댓값은 노이즈(0)보다 크므로 별도 필터 없이 nanmax 사용\n        return round(float(np.nanmax(sbp_data)), 2)\n    except: return None\n\ndef get_sbp_max_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_sbp_max, range(start_id, end_id + 1)))\n    return results",
    "answer": "[322.0, null, 57.0, 239.0, null, null, 268.0, null, null, 282.0, null, 299.0, 167.0, 1.0, null, 234.0, 214.0, null, 154.0, 150.0, null, 267.0, null, 199.0, 179.0, 244.0, 265.0, 189.0, 274.0, null, 199.0, 1.0, null, 231.0, null, null, null, 216.0, null, null, 239.0, null, 212.0, 205.0, null, 205.0, null, null, 273.0, 186.0, 185.0, 175.0, 290.0, null, 185.0, 228.0, null, 294.0, 252.0, 233.0, 270.0, null, null, 202.0, 305.0, 217.0, 273.0, 247.0, 260.0, 265.0, null, null, null, 295.0, 244.0, 286.0, 253.0, null, 249.0, null, null, null, 162.0, 198.0, null, null, 216.0, null, 300.0, null, 6.0, 280.0, 225.0, 318.0, null, 337.0, 222.0, 297.0, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 17,
    "question": "1~100번 환자들의 수축기 혈압(SBP) 최솟값을 각각 구해주세요. (0 이하 노이즈 제외)",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_sbp_min_filtered(case_id):\n    try:\n        # SBP = 'Solar8000/ART_SBP' 트랙\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_SBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        sbp_data = vals[:, 0]\n        # 0 이하 및 NaN 제외\n        valid_sbp = sbp_data[(sbp_data > 0) & (~np.isnan(sbp_data))]\n        \n        if len(valid_sbp) == 0: return None\n        return round(float(np.min(valid_sbp)), 2)\n    except: return None\n\ndef get_sbp_min_batch_filtered(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_sbp_min_filtered, range(start_id, end_id + 1)))\n    return results",
    "answer": "[1.0, null, 1.0, 1.0, null, null, 1.0, null, null, 18.0, null, 9.0, 1.0, 1.0, null, 1.0, 1.0, null, 4.0, 1.0, null, 7.0, null, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, null, 1.0, 1.0, null, 1.0, null, null, null, 1.0, null, null, 1.0, null, 19.0, 1.0, null, 26.0, null, null, 1.0, 81.0, 6.0, 1.0, 1.0, null, 1.0, 4.0, null, 1.0, 2.0, 1.0, 1.0, null, null, 24.0, 3.0, 10.0, 1.0, 1.0, 1.0, 1.0, null, null, null, 1.0, 1.0, 1.0, 2.0, null, 1.0, null, null, null, 1.0, 11.0, null, null, 1.0, null, 1.0, null, 4.0, 1.0, 3.0, 1.0, null, 17.0, 1.0, 3.0, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 18,
    "question": "1~100번 환자들의 수축기 혈압(SBP) 중간값을 각각 구해주세요. (0 이하 노이즈 제외)",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_sbp_median_filtered(case_id):\n    try:\n        # SBP = 'Solar8000/ART_SBP' 트랙\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_SBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        sbp_data = vals[:, 0]\n        # 0 이하 및 NaN 제외\n        valid_sbp = sbp_data[(sbp_data > 0) & (~np.isnan(sbp_data))]\n        \n        if len(valid_sbp) == 0: return None\n        return round(float(np.median(valid_sbp)), 2)\n    except: return None\n\ndef get_sbp_median_batch_filtered(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_sbp_median_filtered, range(start_id, end_id + 1)))\n    return results",
    "answer": "[122.0, null, 23.0, 103.0, null, null, 121.0, null, null, 128.0, null, 96.0, 103.0, 1.0, null, 124.0, 105.0, null, 111.0, 106.0, null, 131.0, null, 125.0, 114.0, 110.0, 109.0, 111.0, 114.0, null, 103.0, 1.0, null, 123.0, null, null, null, 108.0, null, null, 115.0, null, 117.0, 105.0, null, 122.0, null, null, 125.0, 110.0, 131.0, 120.0, 111.0, null, 113.0, 99.0, null, 118.0, 102.0, 118.0, 110.0, null, null, 124.0, 121.0, 111.0, 119.0, 101.0, 123.0, 138.0, null, null, null, 110.0, 101.0, 108.0, 131.0, null, 132.0, null, null, null, 107.0, 118.0, null, null, 87.0, null, 127.0, null, 6.0, 102.0, 113.0, 106.0, null, 109.0, 131.0, 131.0, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 19,
    "question": "1~100번 환자들의 이완기 혈압(DBP)의 평균값, 최댓값, 최솟값, 중간값을 각각 구해주세요. (0 이하 노이즈 제외)",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_dbp_stats(case_id):\n    try:\n        # DBP = 'Solar8000/ART_DBP'\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_DBP'], 1)\n        if vals is None or len(vals) == 0: \n            return None\n        \n        dbp_data = vals[:, 0]\n        # 0 이하 및 NaN 제외\n        valid_dbp = dbp_data[(dbp_data > 0) & (~np.isnan(dbp_data))]\n        \n        if len(valid_dbp) == 0: \n            return None\n            \n        return {\n            \"mean\": round(float(np.mean(valid_dbp)), 2),\n            \"max\": round(float(np.max(valid_dbp)), 2),\n            \"min\": round(float(np.min(valid_dbp)), 2),\n            \"median\": round(float(np.median(valid_dbp)), 2)\n        }\n    except: \n        return None\n\ndef get_dbp_stats_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_dbp_stats, range(start_id, end_id + 1)))\n    return results",
    "answer": "[{\"mean\": 59.28, \"max\": 312.0, \"min\": 1.0, \"median\": 57.0}, null, null, {\"mean\": 53.75, \"max\": 230.0, \"min\": 1.0, \"median\": 53.0}, null, null, {\"mean\": 63.03, \"max\": 254.0, \"min\": 1.0, \"median\": 66.0}, null, null, {\"mean\": 60.19, \"max\": 274.0, \"min\": 16.0, \"median\": 58.0}, null, {\"mean\": 50.62, \"max\": 349.0, \"min\": 1.0, \"median\": 50.0}, {\"mean\": 59.04, \"max\": 101.0, \"min\": 1.0, \"median\": 58.0}, {\"mean\": 1.0, \"max\": 1.0, \"min\": 1.0, \"median\": 1.0}, null, {\"mean\": 60.27, \"max\": 289.0, \"min\": 1.0, \"median\": 62.0}, {\"mean\": 54.34, \"max\": 311.0, \"min\": 1.0, \"median\": 54.0}, null, {\"mean\": 47.44, \"max\": 70.0, \"min\": 12.0, \"median\": 47.0}, {\"mean\": 52.01, \"max\": 70.0, \"min\": 1.0, \"median\": 52.0}, null, {\"mean\": 69.75, \"max\": 350.0, \"min\": 5.0, \"median\": 70.0}, null, {\"mean\": 69.64, \"max\": 148.0, \"min\": 1.0, \"median\": 72.0}, {\"mean\": 63.99, \"max\": 222.0, \"min\": 1.0, \"median\": 67.0}, {\"mean\": 57.58, \"max\": 209.0, \"min\": 1.0, \"median\": 58.0}, {\"mean\": 56.85, \"max\": 258.0, \"min\": 1.0, \"median\": 58.0}, {\"mean\": 62.86, \"max\": 208.0, \"min\": 1.0, \"median\": 64.0}, {\"mean\": 64.03, \"max\": 261.0, \"min\": 1.0, \"median\": 64.0}, null, {\"mean\": 58.42, \"max\": 89.0, \"min\": 1.0, \"median\": 60.0}, {\"mean\": 1.0, \"max\": 1.0, \"min\": 1.0, \"median\": 1.0}, null, {\"mean\": 71.35, \"max\": 236.0, \"min\": 1.0, \"median\": 70.0}, null, null, null, {\"mean\": 53.61, \"max\": 136.0, \"min\": 1.0, \"median\": 53.0}, null, null, {\"mean\": 65.18, \"max\": 140.0, \"min\": 1.0, \"median\": 67.0}, null, {\"mean\": 53.41, \"max\": 168.0, \"min\": 1.0, \"median\": 52.0}, {\"mean\": 65.13, \"max\": 153.0, \"min\": 1.0, \"median\": 65.0}, null, {\"mean\": 63.21, \"max\": 201.0, \"min\": 2.0, \"median\": 62.0}, null, null, {\"mean\": 61.17, \"max\": 253.0, \"min\": 1.0, \"median\": 62.0}, {\"mean\": 58.71, \"max\": 118.0, \"min\": 14.0, \"median\": 59.0}, {\"mean\": 77.88, \"max\": 177.0, \"min\": 5.0, \"median\": 78.0}, {\"mean\": 58.4, \"max\": 162.0, \"min\": 1.0, \"median\": 59.0}, {\"mean\": 71.35, \"max\": 183.0, \"min\": 1.0, \"median\": 68.0}, null, {\"mean\": 57.42, \"max\": 90.0, \"min\": 1.0, \"median\": 55.0}, {\"mean\": 55.68, \"max\": 344.0, \"min\": 1.0, \"median\": 55.0}, null, {\"mean\": 56.1, \"max\": 116.0, \"min\": 1.0, \"median\": 53.0}, {\"mean\": 48.26, \"max\": 317.0, \"min\": 1.0, \"median\": 50.0}, {\"mean\": 62.04, \"max\": 220.0, \"min\": 2.0, \"median\": 62.0}, {\"mean\": 59.99, \"max\": 225.0, \"min\": 1.0, \"median\": 61.0}, null, null, {\"mean\": 65.58, \"max\": 157.0, \"min\": 9.0, \"median\": 63.0}, {\"mean\": 68.12, \"max\": 289.0, \"min\": 1.0, \"median\": 67.0}, {\"mean\": 71.98, \"max\": 214.0, \"min\": 37.0, \"median\": 68.0}, {\"mean\": 58.03, \"max\": 303.0, \"min\": 1.0, \"median\": 57.0}, {\"mean\": 62.68, \"max\": 137.0, \"min\": 1.0, \"median\": 60.0}, {\"mean\": 69.58, \"max\": 193.0, \"min\": 1.0, \"median\": 70.0}, {\"mean\": 66.6, \"max\": 249.0, \"min\": 1.0, \"median\": 68.0}, null, null, null, {\"mean\": 67.82, \"max\": 316.0, \"min\": 1.0, \"median\": 68.0}, {\"mean\": 57.53, \"max\": 232.0, \"min\": 1.0, \"median\": 57.0}, {\"mean\": 71.95, \"max\": 286.0, \"min\": 1.0, \"median\": 67.0}, {\"mean\": 56.35, \"max\": 121.0, \"min\": 2.0, \"median\": 60.0}, null, {\"mean\": 58.58, \"max\": 242.0, \"min\": 1.0, \"median\": 57.0}, null, null, null, {\"mean\": 63.41, \"max\": 305.0, \"min\": 1.0, \"median\": 65.0}, {\"mean\": 62.83, \"max\": 152.0, \"min\": 15.0, \"median\": 62.0}, null, null, {\"mean\": 56.06, \"max\": 201.0, \"min\": 3.0, \"median\": 57.0}, null, {\"mean\": 76.29, \"max\": 276.0, \"min\": 1.0, \"median\": 75.0}, null, null, {\"mean\": 51.44, \"max\": 280.0, \"min\": 1.0, \"median\": 51.0}, {\"mean\": 60.85, \"max\": 135.0, \"min\": 1.0, \"median\": 58.0}, {\"mean\": 57.9, \"max\": 318.0, \"min\": 1.0, \"median\": 56.0}, null, {\"mean\": 59.99, \"max\": 242.0, \"min\": 7.0, \"median\": 59.0}, {\"mean\": 67.51, \"max\": 304.0, \"min\": 1.0, \"median\": 68.0}, {\"mean\": 83.9, \"max\": 200.0, \"min\": 2.0, \"median\": 84.0}, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 20,
    "question": "환자 1-100의 호기말 이산화탄소(EtCO2)의 평균값은?",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_etco2_mean(case_id):\n    try:\n        # EtCO2 = 'Solar8000/ETCO2'\n        vals = vitaldb.load_case(case_id, ['Solar8000/ETCO2'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        etco2_data = vals[:, 0]\n        # 0 이하 및 NaN 제외\n        valid_etco2 = etco2_data[(etco2_data > 0) & (~np.isnan(etco2_data))]\n        \n        if len(valid_etco2) == 0: return None\n        return round(float(np.mean(valid_etco2)), 2)\n    except: return None\n\ndef get_etco2_mean_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_etco2_mean, range(start_id, end_id + 1)))\n    print(\"완료\")\n    return results",
    "answer": "[32.24, 34.01, 32.89, 32.02, 36.99, 31.51, 35.27, 33.39, 35.51, 34.89, 34.73, 33.56, 32.59, 35.08, null, 39.25, 27.82, 24.21, 35.75, 32.29, 33.4, 34.96, 31.96, 36.32, 36.02, 30.58, 33.81, 34.08, 35.21, 34.38, 35.11, 32.59, 31.81, 36.23, 29.96, 31.13, 32.69, 36.11, null, 33.98, 34.68, 37.77, 34.04, 36.17, 35.92, 36.31, 32.95, 33.47, 32.77, 32.2, 32.74, 33.72, 32.0, 39.32, 35.42, 35.18, 33.97, 33.25, 35.16, 35.79, 36.27, 36.21, 31.79, 31.08, 32.93, 33.71, 33.97, 36.14, 35.46, 33.35, 31.81, 34.18, 32.99, 32.65, 35.87, 34.07, 33.2, 36.44, 31.99, 34.08, 37.47, 34.31, 35.89, 33.3, 33.85, 2.0, 39.24, 32.63, 35.03, 37.06, 34.03, 35.66, 35.09, 34.29, 26.56, 35.4, 33.77, 33.85, 33.78, 35.59]",
    "detail_score": 0.75
  },
  {
    "id": 21,
    "question": "환자 1-100의 호기말 이산화탄소(EtCO2)의 최댯값, 최솟값, 중간값은??",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_etco2_stats(case_id):\n    try:\n        # EtCO2 = 'Solar8000/ETCO2'\n        vals = vitaldb.load_case(case_id, ['Solar8000/ETCO2'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        etco2_data = vals[:, 0]\n        # 통상적인 분석을 위해 0 이하 노이즈 제거 (Min 값이 0이 되지 않도록)\n        valid_etco2 = etco2_data[(etco2_data > 0) & (~np.isnan(etco2_data))]\n        \n        if len(valid_etco2) == 0: return None\n        \n        return {\n            \"max\": round(float(np.max(valid_etco2)), 2),\n            \"min\": round(float(np.min(valid_etco2)), 2),\n            \"median\": round(float(np.median(valid_etco2)), 2)\n        }\n    except: return None\n\ndef get_etco2_stats_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_etco2_stats, range(start_id, end_id + 1)))\n    return results",
    "answer": "[{\"max\": 40.0, \"min\": 26.0, \"median\": 32.0}, {\"max\": 39.0, \"min\": 15.0, \"median\": 34.0}, {\"max\": 45.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 38.0, \"min\": 1.0, \"median\": 33.0}, {\"max\": 53.0, \"min\": 6.0, \"median\": 37.0}, {\"max\": 45.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 52.0, \"min\": 1.0, \"median\": 37.0}, {\"max\": 37.0, \"min\": 25.0, \"median\": 34.0}, {\"max\": 41.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 42.0, \"min\": 6.0, \"median\": 35.0}, {\"max\": 42.0, \"min\": 9.0, \"median\": 35.0}, {\"max\": 51.0, \"min\": 2.0, \"median\": 33.0}, {\"max\": 50.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 44.0, \"min\": 1.0, \"median\": 36.0}, null, {\"max\": 49.0, \"min\": 18.0, \"median\": 39.0}, {\"max\": 40.0, \"min\": 1.0, \"median\": 27.0}, {\"max\": 33.0, \"min\": 1.0, \"median\": 28.0}, {\"max\": 43.0, \"min\": 9.0, \"median\": 35.0}, {\"max\": 52.0, \"min\": 1.0, \"median\": 32.0}, {\"max\": 39.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 53.0, \"min\": 10.0, \"median\": 35.0}, {\"max\": 42.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 39.0}, {\"max\": 41.0, \"min\": 1.0, \"median\": 36.0}, {\"max\": 53.0, \"min\": 6.0, \"median\": 30.0}, {\"max\": 41.0, \"min\": 7.0, \"median\": 34.0}, {\"max\": 44.0, \"min\": 6.0, \"median\": 35.0}, {\"max\": 46.0, \"min\": 1.0, \"median\": 36.0}, {\"max\": 41.0, \"min\": 3.0, \"median\": 34.0}, {\"max\": 48.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 48.0, \"min\": 1.0, \"median\": 33.0}, {\"max\": 48.0, \"min\": 6.0, \"median\": 32.0}, {\"max\": 45.0, \"min\": 10.0, \"median\": 35.0}, {\"max\": 36.0, \"min\": 11.0, \"median\": 31.0}, {\"max\": 39.0, \"min\": 21.0, \"median\": 31.0}, {\"max\": 42.0, \"min\": 1.0, \"median\": 33.0}, {\"max\": 57.0, \"min\": 1.0, \"median\": 39.0}, null, {\"max\": 40.0, \"min\": 12.0, \"median\": 34.0}, {\"max\": 42.0, \"min\": 8.0, \"median\": 35.0}, {\"max\": 44.0, \"min\": 1.0, \"median\": 38.0}, {\"max\": 41.0, \"min\": 5.0, \"median\": 35.0}, {\"max\": 51.0, \"min\": 5.0, \"median\": 37.0}, {\"max\": 44.0, \"min\": 1.0, \"median\": 38.0}, {\"max\": 52.0, \"min\": 2.0, \"median\": 37.0}, {\"max\": 41.0, \"min\": 1.0, \"median\": 33.0}, {\"max\": 45.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 79.0, \"min\": 5.0, \"median\": 34.0}, {\"max\": 39.0, \"min\": 14.0, \"median\": 32.0}, {\"max\": 37.0, \"min\": 11.0, \"median\": 34.0}, {\"max\": 40.0, \"min\": 7.0, \"median\": 34.0}, {\"max\": 46.0, \"min\": 8.0, \"median\": 32.0}, {\"max\": 48.0, \"min\": 2.0, \"median\": 39.0}, {\"max\": 40.0, \"min\": 30.0, \"median\": 36.0}, {\"max\": 44.0, \"min\": 8.0, \"median\": 35.0}, {\"max\": 41.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 38.0, \"min\": 24.0, \"median\": 33.0}, {\"max\": 46.0, \"min\": 1.0, \"median\": 38.0}, {\"max\": 39.0, \"min\": 1.0, \"median\": 36.0}, {\"max\": 48.0, \"min\": 12.0, \"median\": 37.0}, {\"max\": 39.0, \"min\": 12.0, \"median\": 36.0}, {\"max\": 44.0, \"min\": 6.0, \"median\": 32.0}, {\"max\": 39.0, \"min\": 1.0, \"median\": 32.0}, {\"max\": 42.0, \"min\": 7.0, \"median\": 33.0}, {\"max\": 49.0, \"min\": 2.0, \"median\": 34.0}, {\"max\": 41.0, \"min\": 6.0, \"median\": 35.0}, {\"max\": 59.0, \"min\": 1.0, \"median\": 37.0}, {\"max\": 49.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 52.0, \"min\": 1.0, \"median\": 33.0}, {\"max\": 40.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 50.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 41.0, \"min\": 8.0, \"median\": 33.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 61.0, \"min\": 1.0, \"median\": 36.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 45.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 44.0, \"min\": 31.0, \"median\": 36.0}, {\"max\": 36.0, \"min\": 10.0, \"median\": 32.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 39.0}, {\"max\": 47.0, \"min\": 12.0, \"median\": 38.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 38.0}, {\"max\": 40.0, \"min\": 20.0, \"median\": 36.0}, {\"max\": 42.0, \"min\": 5.0, \"median\": 34.0}, {\"max\": 47.0, \"min\": 12.0, \"median\": 34.0}, {\"max\": 14.0, \"min\": 1.0, \"median\": 2.0}, {\"max\": 44.0, \"min\": 26.0, \"median\": 39.0}, {\"max\": 39.0, \"min\": 24.0, \"median\": 32.0}, {\"max\": 51.0, \"min\": 5.0, \"median\": 35.0}, {\"max\": 45.0, \"min\": 15.0, \"median\": 37.0}, {\"max\": 41.0, \"min\": 17.0, \"median\": 34.0}, {\"max\": 54.0, \"min\": 1.0, \"median\": 37.0}, {\"max\": 43.0, \"min\": 1.0, \"median\": 36.0}, {\"max\": 44.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 33.0, \"min\": 15.0, \"median\": 27.0}, {\"max\": 47.0, \"min\": 1.0, \"median\": 35.0}, {\"max\": 41.0, \"min\": 19.0, \"median\": 33.0}, {\"max\": 44.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 41.0, \"min\": 1.0, \"median\": 34.0}, {\"max\": 42.0, \"min\": 1.0, \"median\": 38.0}]",
    "detail_score": 0.75
  },
  {
    "id": 22,
    "question": "case id 1-100 환자의 HRV(심박변이도)의 평균값을 구해줘",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_hrv_sdnn(case_id):\n    try:\n        # HRV usually requires ECG analysis (R-R intervals). \n        # For a simple API check without downloading waveforms, we approximate using the HR track.\n        # We calculate SDNN (Standard Deviation of NN intervals) from the 1-second HR data.\n        # This is an approximation.\n        vals = vitaldb.load_case(case_id, ['Solar8000/HR'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        hr_data = vals[:, 0]\n        # Filter valid HR (excluding 0 and NaN)\n        valid_hr = hr_data[(hr_data > 0) & (~np.isnan(hr_data))]\n        \n        if len(valid_hr) < 2: return None\n        \n        # Convert BPM to RR intervals (ms)\n        rr_intervals = 60000 / valid_hr\n        \n        # Calculate SDNN (Standard Deviation of RR intervals)\n        sdnn = np.std(rr_intervals)\n        \n        return round(float(sdnn), 2)\n    except: return None\n\ndef get_hrv_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_hrv_sdnn, range(start_id, end_id + 1)))\n    return results",
    "answer": "[130.78, 95.78, 86.03, 90.46, 36.88, 64.85, 90.12, 71.59, 151.36, 46.84, 100.86, 585.77, 107.76, 1421.94, 103.46, 96.28, 91.14, 133.11, 93.19, 56.39, 101.28, 89.84, 106.43, 77.55, 88.81, 131.03, 118.19, 107.04, 99.46, 52.9, 108.52, 159.8, 114.19, 34.79, 123.26, 116.85, 126.09, 44.4, 85.63, 67.72, 98.47, 134.73, 81.0, 50.59, 132.44, 75.43, 108.38, 151.85, 145.7, 125.52, 88.56, 83.37, 118.6, 67.85, 74.06, 87.59, 85.8, 130.03, 128.33, 54.36, 157.2, 66.52, 119.86, 123.06, 144.28, 106.88, 92.77, 70.22, 120.58, 86.59, 139.7, 57.12, 146.74, 129.51, 99.87, 62.25, 345.94, 100.14, 119.5, 88.08, 77.77, 83.78, 144.56, 60.62, 129.37, 34.31, 28.08, 63.89, 55.42, 123.39, 87.47, 118.82, 139.03, 115.95, 97.96, 133.29, 102.86, 115.56, 65.15, 111.96]",
    "detail_score": 0.6
  },
  {
    "id": 23,
    "question": "환자 1-100의 90mmHg이상의 DBP 값이 몇 분간 지속되었는지 알려줘",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_dbp_over_90_duration(case_id):\n    try:\n        # 지속 시간을 계산하려면 연속 데이터인 'Solar8000/ART_DBP' (1초 간격)가 적합\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_DBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        dbp_data = vals[:, 0]\n        # NaN 제외\n        valid_dbp = dbp_data[~np.isnan(dbp_data)]\n        \n        if len(valid_dbp) == 0: return 0.0\n        \n        # 90 이상인 데이터 포인트 개수 (1초 간격이므로 개수 = 초)\n        count_seconds = np.sum(valid_dbp >= 90)\n        \n        # 분(minute) 단위로 변환\n        duration_min = round(count_seconds / 60.0, 2)\n        \n        return duration_min\n    except: return None\n\ndef get_dbp_duration_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_dbp_over_90_duration, range(start_id, end_id + 1)))\n    return results",
    "answer": "[4.0, null, 0.0, 0.97, null, null, 2.58, null, null, 2.9, null, 0.18, 1.17, 0.0, null, 0.07, 0.03, null, 0.0, 0.0, null, 2.77, null, 5.15, 1.8, 0.8, 0.15, 0.78, 0.65, null, 0.0, 0.0, null, 16.25, null, null, null, 0.25, null, null, 0.9, null, 0.03, 7.05, null, 2.08, null, null, 0.68, 1.28, 6.23, 0.15, 11.33, null, 0.05, 0.48, null, 1.9, 0.08, 0.3, 0.88, null, null, 6.18, 4.2, 5.33, 0.93, 2.7, 1.75, 2.92, null, null, null, 3.1, 0.78, 4.23, 0.03, null, 3.95, null, null, null, 0.28, 0.28, null, null, 0.4, null, 11.37, null, 0.0, 1.48, 2.18, 1.72, null, 4.02, 0.2, 16.2, null, null]",
    "detail_score": 0.85
  },
  {
    "id": 24,
    "question": "case id 1-100이 50mmHg 이하의 DBP 값이 몇 분간 지속되었는지 알려줘",
    "tool": "import vitaldb\nimport numpy as np\nimport concurrent.futures\n\ndef fetch_dbp_under_50_duration(case_id):\n    try:\n        # Load DBP track\n        vals = vitaldb.load_case(case_id, ['Solar8000/ART_DBP'], 1)\n        if vals is None or len(vals) == 0: return None\n        \n        dbp_data = vals[:, 0]\n        # 중요: 0보다 크고 50 이하인 값만 필터링 (0은 노이즈로 간주하고 제외)\n        valid_dbp = dbp_data[(dbp_data > 0) & (~np.isnan(dbp_data))]\n        \n        if len(valid_dbp) == 0: return 0.0\n        \n        # 50 이하인 샘플 개수 (1초 간격)\n        count_seconds = np.sum(valid_dbp <= 50)\n        \n        # 분 단위 변환\n        duration_min = round(count_seconds / 60.0, 2)\n        \n        return duration_min\n    except: return None\n\ndef get_dbp_low_duration_batch(start_id=1, end_id=100):\n    with concurrent.futures.ThreadPoolExecutor(max_workers=20) as executor:\n        results = list(executor.map(fetch_dbp_under_50_duration, range(start_id, end_id + 1)))\n    return results",
    "answer": "[30.88, null, 0.0, 53.2, null, null, 9.48, null, null, 30.5, null, 117.25, 10.7, 0.73, null, 19.23, 33.13, null, 164.67, 67.95, null, 0.9, null, 5.8, 13.6, 14.83, 28.53, 30.38, 4.53, null, 8.87, 3.33, null, 2.1, null, null, null, 20.58, null, null, 9.05, null, 43.23, 5.55, null, 6.65, null, null, 4.83, 17.62, 0.68, 15.23, 1.05, null, 42.1, 36.82, null, 47.38, 11.87, 5.07, 8.45, null, null, 11.97, 3.08, 0.7, 23.4, 2.85, 1.9, 5.32, null, null, null, 3.63, 37.57, 0.73, 19.82, null, 32.33, null, null, null, 10.77, 4.9, null, null, 18.28, null, 1.63, null, 0.0, 16.17, 5.72, 32.25, null, 24.67, 3.23, 1.22, null, null]",
    "detail_score": 0.8
  }
]